<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../polymer/polymer.html">

<!--



Example:

    <buuild-source-select>
        <buuild-source-select-item tree-id="99" categories="abc,def"></buuild-source-select-item>
    </buuild-source-select>

@demo
-->
<dom-module id="buuild-source-select">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
    }

  </style>

  <template>
    <content></content>
      <button id="add">Hinzufügen</button>

	<iron-ajax id="queryTreeIds" url="http://www.mocky.io/v2/5729139b0f00002324e2940b" params='{}'  handle-as="json" on-response="handleResponseTreeIds"  debounce-duration="300"></iron-ajax>
	<iron-ajax id="queryCategoriesUuid" url="http://www.mocky.io/v2/5729154c0f00006e24e29410" params='{}'  handle-as="json" on-response="handleResponseCategoriesUuid"  debounce-duration="300"></iron-ajax>

  </template>

</dom-module>

<dom-module id="buuild-source-select-item">

  <style>
    :host {
      display: block;
      box-sizing: border-box;
      border-bottom: 1px solid #eee;
      line-height: 150%;
  }
   
  :host ::content em {
    
      display: inline-block;
      background: #eee;
      padding: 2px 10px;
      font-size: 12px;
      line-height: 100%;    
      font-style: normal;
  }

  </style>

  <template>
    <content></content>
    <button id="delete">Löschen</button>
  </template>

</dom-module>

<script>

  Polymer({

    is: 'buuild-source-select',

    properties: {

        deletable: {
            
            type: Boolean,
            value: true
        },
    },

    // Element Lifecycle

    ready: function() {
      // `ready` is called after all elements have been configured, but
      // propagates bottom-up. This element's children are ready, but parents
      // are not.
      //
      // This is the point where you should make modifications to the DOM (when
      // necessary), or kick off any processes the element wants to perform.
    },

    attached: function() {
      // `attached` fires once the element and its parents have been inserted
      // into a document.
      //
      // This is a good place to perform any work related to your element's
      // visual state or active behavior (measuring sizes, beginning animations,
      // loading resources, etc).

        var these = this;

       // Assign items to element
       
        these.$.add.addEventListener('click', these.addItem.bind(these));
    },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.
    },

    // Element Behavior
      
    items: function() {
    
        var these =this;
        return these.getEffectiveChildren();
    },

    addItem: function() {

        

    },

    // Selection dialog for trees 
    selectTreeId: function() {

    },

    // Selection dialog for categories 
    selectCategoriesUuid: function() {

    },

  });

 Polymer({

    is: 'buuild-source-select-item',

    properties: {

        treeId: {

            type: Number
        },

        categoriesUuid: {

            type: String
        }

    },

    // Element Lifecycle

    ready: function() {
      // `ready` is called after all elements have been configured, but
      // propagates bottom-up. This element's children are ready, but parents
      // are not.
      //
      // This is the point where you should make modifications to the DOM (when
      // necessary), or kick off any processes the element wants to perform.
    },

    attached: function() {
      // `attached` fires once the element and its parents have been inserted
      // into a document.
      //
      // This is a good place to perform any work related to your element's
      // visual state or active behavior (measuring sizes, beginning animations,
      // loading resources, etc).

        var these = this;

        var deleteButton = these.$.delete;

        deleteButton.addEventListener('click', these.removeItem.bind(these) );

   },

    detached: function() {
      // The analog to `attached`, `detached` fires when the element has been
      // removed from a document.
      //
      // Use this to clean up anything you did in `attached`.

   
    },

    // Remove item
    removeItem: function() {

        var these = this;

        if ( confirm("Wirklich löschen?") ) {
        
            var parent = these.parentNode;
            Polymer.dom(parent).removeChild(these);
        }
    },

  });


</script>
